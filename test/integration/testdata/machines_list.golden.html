<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Users - Headscale Admin</title> <script src="/static/js/tailwind-3.4.17.js"></script> <script src="/static/js/htmx-1.9.10.min.js"></script> <script src="/static/js/htmx-sse-1.9.10.js"></script> <style> .navigation-link { position: relative; } .navigation-link-active::after { content: ''; position: absolute; bottom: 0; left: 0.75rem; right: 0.75rem; height: 2px; background-color: currentColor; } .tb { width: 100%; border-collapse: separate; border-spacing: 0; } .tb thead th { text-align: left; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: #9ca3af; padding: 0.75rem 1.5rem; border-bottom: 1px solid #374151; } .tb tbody tr { border-bottom: 1px solid #374151; } .tb tbody td { padding: 1rem 1.5rem; } @keyframes slide-in { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } } .animate-slide-in { animation: slide-in 0.3s ease-out; } #toast-container { position: fixed; top: 1rem; right: 1rem; z-index: 1000; display: flex; flex-direction: column; gap: 0.5rem; max-width: 24rem; } .toast { padding: 1rem; border-radius: 0.5rem; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2); display: flex; align-items: start; gap: 0.75rem; animation: slideIn 0.3s ease-out; } .toast.error { background-color: #7f1d1d; border: 1px solid #991b1b; color: #fca5a5; } .toast.success { background-color: #14532d; border: 1px solid #166534; color: #86efac; } .toast.info { background-color: #1e3a8a; border: 1px solid #1e40af; color: #93c5fd; } @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } } .toast-close { cursor: pointer; opacity: 0.5; transition: opacity 0.2s; } .toast-close:hover { opacity: 1; } </style> </head> <body class="bg-gray-900 text-gray-100 min-h-screen" hx-ext="sse" sse-connect="/events"> <div id="alert-container" class="fixed top-4 right-4 z-50 w-96 space-y-2"></div> <div class="bg-black border-b border-gray-800 pt-4 mb-6"> <div class="container mx-auto mb-4 md:mb-6"> <header class="flex justify-between items-center px-2 md:px-0 gap-4"> <div class="flex items-center min-w-0 gap-3"> <a href="/" class="flex items-center min-w-0 gap-3 text-gray-100"> <svg width="18" height="18" viewBox="0 0 23 23" fill="none" class="shrink-0"> <circle opacity="0.2" cx="3.4" cy="3.25" r="2.7" fill="currentColor"></circle> <circle cx="3.4" cy="11.3" r="2.7" fill="currentColor"></circle> <circle opacity="0.2" cx="3.4" cy="19.5" r="2.7" fill="currentColor"></circle> <circle cx="11.5" cy="11.3" r="2.7" fill="currentColor"></circle> <circle cx="11.5" cy="19.5" r="2.7" fill="currentColor"></circle> <circle opacity="0.2" cx="11.5" cy="3.25" r="2.7" fill="currentColor"></circle> <circle opacity="0.2" cx="19.5" cy="3.25" r="2.7" fill="currentColor"></circle> <circle cx="19.5" cy="11.3" r="2.7" fill="currentColor"></circle> <circle opacity="0.2" cx="19.5" cy="19.5" r="2.7" fill="currentColor"></circle> </svg> <div class="text-lg font-semibold truncate">Headscale Admin</div> </a> </div> </header> </div> <div class="relative overflow-hidden"> <nav class="flex items-center overflow-auto left-1 relative md:container md:mx-auto md:px-0"> <a class="whitespace-nowrap py-2 group relative text-gray-100" href="/"> <div class="px-3 py-2 flex items-center rounded-md hover:bg-gray-700 navigation-link navigation-link-active"> <svg class="w-4 h-4 mr-2 hidden sm:inline-block" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"> <rect width="20" height="8" x="2" y="2" rx="2" ry="2"></rect> <rect width="20" height="8" x="2" y="14" rx="2" ry="2"></rect> <line x1="6" x2="6.01" y1="6" y2="6"></line> <line x1="6" x2="6.01" y1="18" y2="18"></line> </svg> <div>Machines</div> </div> </a> <a class="whitespace-nowrap py-2 group relative text-gray-400 hover:text-gray-200" href="/users"> <div class="px-3 py-2 flex items-center rounded-md hover:bg-gray-700 navigation-link "> <svg class="w-4 h-4 mr-2 hidden sm:inline-block" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path> <circle cx="9" cy="7" r="4"></circle> <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path> <path d="M16 3.13a4 4 0 0 1 0 7.75"></path> </svg> <div>Users</div> </div> </a> </nav> </div> </div> <main class="container mx-auto pb-20 md:pb-24"> <section class="mb-24"> <header class="flex gap-2 mb-6"> <div class="flex-grow"> <div class="flex flex-wrap justify-between items-center gap-x-4 gap-y-2"> <div class="flex items-center"> <h1 class="text-3xl font-semibold tracking-tight leading-tight">Machines</h1> </div> </div> <p class="mt-2 max-w-[40rem] text-gray-400"> Manage the devices connected to your network. </p> </div> </header> <div class="mt-6 mb-6 flex justify-start gap-4"> <div class="flex-1"> <div class="flex flex-wrap gap-x-4 gap-y-2 sm:flex-nowrap"> <form class="w-full flex-shrink-0 max-w-2xl sm:flex-shrink"> <div class="relative"> <svg class="absolute text-gray-500 h-full ml-2 w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="m21 21-4.34-4.34"></path> <circle cx="11" cy="11" r="8"></circle> </svg> <input type="text" name="query" placeholder="Search by name, owner, tag, version..." value="" class="w-full pl-8 pr-4 py-2 bg-gray-800 border border-gray-700 text-gray-100 placeholder-gray-500 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" hx-get="/machines" hx-trigger="keyup changed delay:XXms" hx-target="#machines-table" hx-select="#machines-table"> </div> </form> </div> </div> </div> <div class="inline-flex items-center align-middle justify-center font-medium border border-gray-700 bg-gray-800 text-gray-300 rounded-full px-2 py-1 leading-none text-sm mb-8"> 2 machines </div> <div id="machines-table" sse-swap="machinesTable"> <table class="tb bg-gray-800 rounded-lg shadow-sm"> <thead> <tr> <th class="md:w-1/3">Machine</th> <th class="hidden md:table-cell md:w-1/4">Addresses</th> <th class="hidden md:table-cell w-1/4 lg:w-1/5">Version</th> <th class="hidden lg:table-cell md:flex-auto">Last Seen</th> <th class="w-16"></th> </tr> </thead> <tbody> <tr id="machine-1" class="group hover:bg-gray-700 cursor-pointer"> <td class="md:w-1/3"> <div class="relative"> <div class="items-center"> <p class="font-semibold hover:text-gray-300"> <span class="inline-block w-2 h-2 rounded-full bg-green-500 relative -top-px lg:hidden mr-2"></span> <a href="/machines/1" class="text-gray-100">hsadmin-test</a> </p> </div> <div class=""> <div class="flex items-center text-sm text-gray-400"> <span>testuser</span> </div> </div> <div id="machine-1-badges" class="flex gap-2 flex-wrap mt-2"> </div> </div> </td> <td class="hidden md:table-cell md:w-1/4"> <span class="text-gray-100">100.64.X.X</span> <span class="text-sm text-gray-500"> (+1)</span> </td> <td class="hidden md:table-cell w-1/4 lg:w-1/5"> <div class="flex items-center relative"> <div data-ts-version>TAILSCALE_VERSION</div> </div> <div class="text-sm truncate text-gray-400">linux</div> </td> <td class="hidden lg:table-cell md:flex-auto"> <span id="machine-1-status" class="text-sm"> <span class="inline-block w-2 h-2 rounded-full bg-green-500 mr-2"></span> CONNECTED </span> </td> <td class="w-16"> <div class="flex justify-end"> <details class="relative"> <summary data-testid="machine-menu-button" class="p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-md cursor-pointer list-none"> <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"> <path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"/> </svg> </summary> <div data-testid="machine-menu-dropdown" class="absolute right-0 mt-2 w-56 bg-gray-800 rounded-md shadow-lg ring-1 ring-gray-700 z-10"> <div class="py-1"> <a href="#" onclick="showRenameMachineModal('1', 'hsadmin-test'); return false;" data-testid="machine-menu-rename" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700"> <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M17 3a2.83 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"></path> </svg> Rename machine </a> <a href="#" onclick="showMoveMachineModal('1', 'hsadmin-test', 'testuser'); return false;" data-testid="machine-menu-move" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700"> <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path> <circle cx="9" cy="7" r="4"></circle> <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path> <path d="M16 3.13a4 4 0 0 1 0 7.75"></path> </svg> Move to user </a> <a href="#" onclick="showTagsModal('1', 'hsadmin-test', ''); return false;" data-testid="machine-menu-tags" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700"> <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path> <line x1="7" x2="7.01" y1="7" y2="7"></line> </svg> Manage tags </a> <div class="border-t border-gray-700 my-1"></div> <a href="#" onclick="showExpireMachineModal('1', 'hsadmin-test'); return false;" data-testid="machine-menu-expire" class="block px-4 py-2 text-sm text-yellow-400 hover:bg-gray-700"> <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <circle cx="12" cy="12" r="10"></circle> <polyline points="12 6 12 12 16 14"></polyline> </svg> Expire key </a> <a href="#" onclick="showDeleteMachineModal('1', 'hsadmin-test'); return false;" data-testid="machine-menu-delete" class="block px-4 py-2 text-sm text-red-400 hover:bg-gray-700"> <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M3 6h18"></path> <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path> <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path> <line x1="10" x2="10" y1="11" y2="17"></line> <line x1="14" x2="14" y1="11" y2="17"></line> </svg> Delete machine </a> </div> </div> </details> </div> </td> </tr> <tr id="machine-2" class="group hover:bg-gray-700 cursor-pointer"> <td class="md:w-1/3"> <div class="relative"> <div class="items-center"> <p class="font-semibold hover:text-gray-300"> <span class="inline-block w-2 h-2 rounded-full bg-green-500 relative -top-px lg:hidden mr-2"></span> <a href="/machines/2" class="text-gray-100">test-client</a> </p> </div> <div class=""> <div class="flex items-center text-sm text-gray-400"> <span>testuser</span> </div> </div> <div id="machine-2-badges" class="flex gap-2 flex-wrap mt-2"> </div> </div> </td> <td class="hidden md:table-cell md:w-1/4"> <span class="text-gray-100">100.64.X.X</span> <span class="text-sm text-gray-500"> (+1)</span> </td> <td class="hidden md:table-cell w-1/4 lg:w-1/5"> <div class="flex items-center relative"> <div data-ts-version>TAILSCALE_VERSION</div> </div> <div class="text-sm truncate text-gray-400">linux</div> </td> <td class="hidden lg:table-cell md:flex-auto"> <span id="machine-2-status" class="text-sm"> <span class="inline-block w-2 h-2 rounded-full bg-green-500 mr-2"></span> CONNECTED </span> </td> <td class="w-16"> <div class="flex justify-end"> <details class="relative"> <summary data-testid="machine-menu-button" class="p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-md cursor-pointer list-none"> <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"> <path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"/> </svg> </summary> <div data-testid="machine-menu-dropdown" class="absolute right-0 mt-2 w-56 bg-gray-800 rounded-md shadow-lg ring-1 ring-gray-700 z-10"> <div class="py-1"> <a href="#" onclick="showRenameMachineModal('2', 'test-client'); return false;" data-testid="machine-menu-rename" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700"> <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M17 3a2.83 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"></path> </svg> Rename machine </a> <a href="#" onclick="showMoveMachineModal('2', 'test-client', 'testuser'); return false;" data-testid="machine-menu-move" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700"> <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path> <circle cx="9" cy="7" r="4"></circle> <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path> <path d="M16 3.13a4 4 0 0 1 0 7.75"></path> </svg> Move to user </a> <a href="#" onclick="showTagsModal('2', 'test-client', ''); return false;" data-testid="machine-menu-tags" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700"> <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path> <line x1="7" x2="7.01" y1="7" y2="7"></line> </svg> Manage tags </a> <div class="border-t border-gray-700 my-1"></div> <a href="#" onclick="showExpireMachineModal('2', 'test-client'); return false;" data-testid="machine-menu-expire" class="block px-4 py-2 text-sm text-yellow-400 hover:bg-gray-700"> <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <circle cx="12" cy="12" r="10"></circle> <polyline points="12 6 12 12 16 14"></polyline> </svg> Expire key </a> <a href="#" onclick="showDeleteMachineModal('2', 'test-client'); return false;" data-testid="machine-menu-delete" class="block px-4 py-2 text-sm text-red-400 hover:bg-gray-700"> <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M3 6h18"></path> <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path> <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path> <line x1="10" x2="10" y1="11" y2="17"></line> <line x1="14" x2="14" y1="11" y2="17"></line> </svg> Delete machine </a> </div> </div> </details> </div> </td> </tr> </tbody> </table> </div> </section> <dialog id="renameMachineModal" class="rounded-lg shadow-xl p-0 bg-gray-800 backdrop:bg-gray-900 backdrop:bg-opacity-75"> <div class="p-5 w-96 bg-gray-800 rounded-lg"> <div class="mt-3"> <h3 class="text-lg font-medium leading-6 text-gray-100 mb-4">Rename Machine</h3> <form id="renameMachineForm" method="POST" hx-post="" hx-target="body" hx-swap="outerHTML" hx-push-url="true"> <div class="mb-4"> <label for="renameMachineNewName" class="block text-sm font-medium text-gray-300 mb-1">New Name</label> <input type="text" name="new_name" id="renameMachineNewName" required class="w-full px-4 py-2 bg-gray-700 border border-gray-600 text-gray-100 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"> </div> <div class="flex gap-2 justify-end"> <button type="button" onclick="document.getElementById('renameMachineModal').close()" class="px-4 py-2 bg-gray-700 text-gray-300 rounded-md hover:bg-gray-600"> Cancel </button> <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"> Rename </button> </div> </form> </div> </div> </dialog> <dialog id="moveMachineModal" data-testid="move-modal" class="rounded-lg shadow-xl p-0 bg-gray-800 backdrop:bg-gray-900 backdrop:bg-opacity-75"> <div class="p-5 w-96 bg-gray-800 rounded-lg"> <div class="mt-3"> <h3 class="text-lg font-medium leading-6 text-gray-100 mb-4">Move Machine to User</h3> <form id="moveMachineForm" method="POST" hx-post="" hx-target="body" hx-swap="outerHTML" hx-push-url="true"> <div class="mb-4"> <label for="moveMachineName" class="block text-sm font-medium text-gray-300 mb-1">Machine</label> <input type="text" id="moveMachineName" readonly class="w-full px-4 py-2 bg-gray-700 border border-gray-600 text-gray-400 rounded-md cursor-not-allowed"> </div> <div class="mb-4"> <label for="moveMachineCurrentUser" class="block text-sm font-medium text-gray-300 mb-1">Current User</label> <input type="text" id="moveMachineCurrentUser" readonly class="w-full px-4 py-2 bg-gray-700 border border-gray-600 text-gray-400 rounded-md cursor-not-allowed"> </div> <div class="mb-4"> <label for="moveMachineTargetUser" class="block text-sm font-medium text-gray-300 mb-1">Target User</label> <select name="target_user" id="moveMachineTargetUser" data-testid="move-target-user" required class="w-full px-4 py-2 bg-gray-700 border border-gray-600 text-gray-100 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"> <option value="">Select a user...</option> <option value="1">testuser</option> </select> </div> <div class="flex gap-2 justify-end"> <button type="button" onclick="document.getElementById('moveMachineModal').close()" class="px-4 py-2 bg-gray-700 text-gray-300 rounded-md hover:bg-gray-600"> Cancel </button> <button type="submit" data-testid="move-submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"> Move </button> </div> </form> </div> </div> </dialog> <dialog id="tagsModal" data-testid="tags-modal" class="rounded-lg shadow-xl p-0 bg-gray-800 backdrop:bg-gray-900 backdrop:bg-opacity-75"> <div class="p-5 w-96 bg-gray-800 rounded-lg"> <div class="mt-3"> <h3 class="text-lg font-medium leading-6 text-gray-100 mb-4">Manage Tags</h3> <form id="tagsForm" method="POST" hx-post="" hx-target="body" hx-swap="outerHTML" hx-push-url="true"> <div class="mb-4"> <label for="tagsMachineName" class="block text-sm font-medium text-gray-300 mb-1">Machine</label> <input type="text" id="tagsMachineName" readonly class="w-full px-4 py-2 bg-gray-700 border border-gray-600 text-gray-400 rounded-md cursor-not-allowed"> </div> <div class="mb-4"> <label for="tagsInput" class="block text-sm font-medium text-gray-300 mb-1">Tags (comma-separated)</label> <input type="text" name="tags" id="tagsInput" data-testid="tags-input" placeholder="tag:example, tag:production" class="w-full px-4 py-2 bg-gray-700 border border-gray-600 text-gray-100 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"> <p class="mt-1 text-sm text-gray-400">Enter tags separated by commas. Leave empty to remove all tags.</p> </div> <div class="flex gap-2 justify-end"> <button type="button" onclick="document.getElementById('tagsModal').close()" class="px-4 py-2 bg-gray-700 text-gray-300 rounded-md hover:bg-gray-600"> Cancel </button> <button type="submit" data-testid="tags-submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"> Save </button> </div> </form> </div> </div> </dialog> <dialog id="expireMachineModal" data-testid="expire-modal" class="rounded-lg shadow-xl p-0 bg-gray-800 backdrop:bg-gray-900 backdrop:bg-opacity-75"> <div class="p-5 w-96 bg-gray-800 rounded-lg"> <div class="mt-3"> <h3 class="text-lg font-medium leading-6 text-gray-100 mb-4">Expire Machine Key</h3> <form id="expireMachineForm" method="POST" hx-post="" hx-target="body" hx-swap="outerHTML" hx-push-url="true"> <div class="mb-4"> <label for="expireMachineName" class="block text-sm font-medium text-gray-300 mb-1">Machine</label> <input type="text" id="expireMachineName" readonly class="w-full px-4 py-2 bg-gray-700 border border-gray-600 text-gray-400 rounded-md cursor-not-allowed"> </div> <div class="mb-4 p-3 bg-yellow-900 bg-opacity-30 border border-yellow-700 rounded-md"> <p class="text-sm text-yellow-300"> <svg class="w-5 h-5 inline mr-1" fill="currentColor" viewBox="0 0 20 20"> <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/> </svg> The machine will need to re-authenticate to rejoin the network. </p> </div> <div class="flex gap-2 justify-end"> <button type="button" onclick="document.getElementById('expireMachineModal').close()" class="px-4 py-2 bg-gray-700 text-gray-300 rounded-md hover:bg-gray-600"> Cancel </button> <button type="submit" data-testid="expire-submit" class="px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700"> Expire Key </button> </div> </form> </div> </div> </dialog> <dialog id="deleteMachineModal" data-testid="delete-modal" class="rounded-lg shadow-xl p-0 bg-gray-800 backdrop:bg-gray-900 backdrop:bg-opacity-75"> <div class="p-5 w-96 bg-gray-800 rounded-lg"> <div class="mt-3"> <h3 class="text-lg font-medium leading-6 text-gray-100 mb-4">Delete Machine</h3> <form id="deleteMachineForm" method="POST" hx-post="" hx-target="body" hx-swap="outerHTML" hx-push-url="true"> <div class="mb-4"> <label for="deleteMachineName" class="block text-sm font-medium text-gray-300 mb-1">Machine</label> <input type="text" id="deleteMachineName" readonly class="w-full px-4 py-2 bg-gray-700 border border-gray-600 text-gray-400 rounded-md cursor-not-allowed"> </div> <div class="mb-4 p-3 bg-red-900 bg-opacity-30 border border-red-700 rounded-md"> <p class="text-sm text-red-300"> <svg class="w-5 h-5 inline mr-1" fill="currentColor" viewBox="0 0 20 20"> <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/> </svg> This action cannot be undone. The machine will be permanently deleted from Headscale. </p> </div> <div class="flex gap-2 justify-end"> <button type="button" onclick="document.getElementById('deleteMachineModal').close()" class="px-4 py-2 bg-gray-700 text-gray-300 rounded-md hover:bg-gray-600"> Cancel </button> <button type="submit" data-testid="delete-submit" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700"> Delete Machine </button> </div> </form> </div> </div> </dialog> <script> function showRenameMachineModal(machineID, machineName) { const modal = document.getElementById('renameMachineModal'); const form = document.getElementById('renameMachineForm'); document.getElementById('renameMachineNewName').value = machineName; form.setAttribute('hx-post', '/machines/' + machineID + '/rename'); modal.showModal(); htmx.process(form); } function showMoveMachineModal(machineID, machineName, currentUser) { const modal = document.getElementById('moveMachineModal'); const form = document.getElementById('moveMachineForm'); document.getElementById('moveMachineName').value = machineName; document.getElementById('moveMachineCurrentUser').value = currentUser; document.getElementById('moveMachineTargetUser').value = ''; form.setAttribute('hx-post', '/machines/' + machineID + '/move'); modal.showModal(); htmx.process(form); } function showTagsModal(machineID, machineName, currentTags) { const modal = document.getElementById('tagsModal'); const form = document.getElementById('tagsForm'); document.getElementById('tagsMachineName').value = machineName; document.getElementById('tagsInput').value = currentTags; form.setAttribute('hx-post', '/machines/' + machineID + '/tags'); modal.showModal(); htmx.process(form); } function showExpireMachineModal(machineID, machineName) { const modal = document.getElementById('expireMachineModal'); const form = document.getElementById('expireMachineForm'); document.getElementById('expireMachineName').value = machineName; form.setAttribute('hx-post', '/machines/' + machineID + '/expire'); modal.showModal(); htmx.process(form); } function showDeleteMachineModal(machineID, machineName) { const modal = document.getElementById('deleteMachineModal'); const form = document.getElementById('deleteMachineForm'); document.getElementById('deleteMachineName').value = machineName; form.setAttribute('hx-post', '/machines/' + machineID + '/delete'); modal.showModal(); htmx.process(form); } document.body.addEventListener('htmx:afterRequest', function(event) { if (event.detail.successful && event.detail.elt.id === 'renameMachineForm') { document.getElementById('renameMachineModal').close(); } if (event.detail.successful && event.detail.elt.id === 'moveMachineForm') { document.getElementById('moveMachineModal').close(); } if (event.detail.successful && event.detail.elt.id === 'tagsForm') { document.getElementById('tagsModal').close(); } if (event.detail.successful && event.detail.elt.id === 'expireMachineForm') { document.getElementById('expireMachineModal').close(); } if (event.detail.successful && event.detail.elt.id === 'deleteMachineForm') { document.getElementById('deleteMachineModal').close(); } }); document.addEventListener('click', function(event) { const openDetails = document.querySelectorAll('details[open]'); openDetails.forEach(function(details) { if (!details.contains(event.target)) { details.removeAttribute('open'); } }); }); </script> </main> </body> </html>